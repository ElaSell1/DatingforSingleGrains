---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# DatingforSingleGrains

<!-- badges: start -->
<!-- badges: end -->

The goal of DatingforSingleGrains is to provide the data analysis stages for the functions used during the FACT project, wherein high-resolution single-quartz-grain optically stimulated luminescence was used to date the archeological site of Chez-Pinaud, France.  Within this package is the raw .BINX files containing the original OSL measurement data and metadata file, an example Excel sheet and metadata file, as well as an Excel sheet with dose rate data. 

## Installation

You can install the development version of DatingforSingleGrains from [GitHub](https://github.com/) with:

``` r
# install.packages("pak")
pak::pak("ElaSell1/DatingforSingleGrains")
```

## Example

Below shows how you can use the data in the All_CPJB_L11.xlsx file to continue grain selection and then calculate ages. 

```{r example}
library(DatingforSingleGrains)
## Go see the sun. It has missed you.

file <- "data/All_CPJB_L11.xlsx"

## 1. Update excel file. ##########################################
file_names <- c("521_20240806-CPJB-L6-16Pos1-44-De_determination.binx", "522_20241002-CPJB-L10-14-De_determination.binx")
file_dose_rates <- c(0.158, 0.166)
file_dr_err <- c(0.007, 0.007)

reader_dose_rates <- data.frame(file_names, file_dose_rates, file_dr_err)

## Convert De S to De Gy ###########################################
## add_DeGy_columns <- function(file_path, dose_rates)
osl_data_Gy <- add_DeGy_columns(file, reader_dose_rates)

## Filter grains ###################################################
## filter_OSL_grains <- function(data, filter_options = "all", d0filt_limit = NULL, plots = TRUE)
## Filter options: "all","positive" "feldsparfilt" "d0filt" "recuperation" "zerodoserem" "nanrem"
filt_data_gy <- filter_OSL_grains(osl_data_Gy, filter_options = "all")

## Summary statistics ##############################################
## grain_summary_stats <- function(datasets, samplename,  path_for_save = NULL)
stats <- grain_summary_stats(filt_data_gy, file,  path_for_save = "Test_folder")

## Save files for BayLum ###########################################
## save_discpos_files <- function(path, data, discpos_to_save = NULL, discpos_to_use = NULL, env_dose_rates = NULL, reader_dose_rates = NULL)
## dispos_to_use options: options: "all","positive" "feldsparfilt" "d0filt" "recuperation" "zerodoserem" "nanrem"
env_dose_rate = c(1.55, 0.0007)

save_discpos_files("Test_folder", filt_data_gy, discpos_to_use = "d0filt", reader_dose_rates, env_dose_rates)

## NOTE: You will need to save your original Binx files in each resepctive folder which is generated from the save_discpos_files function.


```

What is special about using `README.Rmd` instead of just `README.md`? You can include R chunks like so:

```{r cars}
summary(cars)
```

